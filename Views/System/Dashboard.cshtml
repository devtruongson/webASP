<div class="main">
    <div class="container">
        <div class="row">
            <div class="col-2">
                <div class="sibar">
                    <div class="sibar-control">
                        <button id="btn-info-admin" data-render="manage-admin" class="">Quản Lí Thông tin</button>
                    </div>
                    <div class="sibar-control">
                        <button id="btn-price" data-render="manage-price">Quản Lí Price</button>
                    </div>
                    <div class="sibar-control">
                        <button id="btn-price" data-render="rented-bike">Xem xe đã thuê</button>
                    </div>
                    <div class="sibar-control">
                        <button id="btn-price" data-render="all-code-control">Quản lý dữ liệu chung</button>
                    </div>
                </div>
            </div>

            <div class="col-10 min-vh-100" id="">
                <div class="form-info-admin form-content"></div>
            </div>
        </div>
    </div>
</div>


<script>
    if (!JSON.parse(localStorage.getItem("isLoginIn"))) {
        alert("Bạn không có quyền!");
        window.location.href = "http://localhost:8080/System";
    }
    const arrRender = [{
        renderKey: "manage-admin",
        elementRender: `~/Views/System/InfoAdmin.cshtml`
    }, {
        renderKey: "manage-price",
        elementRender: "~/Views/System/PriceCars.cshtml"
    }, {
        renderKey: "manage-blogs",
        elementRender: "~/Views/System/blog.cshtml",
        urlScript: "/assets/js/blog.js",
        class: "script-blog"
    }]

    function loadPartial(query, callback) {
        fetch(`/System/InfoAdmin?query=${query}`)
            .then(async (res) => await res.text())
            .then(res => {
                callback(res)
            })
    }

    function renderPartial(content) {
        renderContent.innerHTML = content;
    }

    loadPartial("~/Views/System/InfoAdmin.cshtml", renderPartial)
    const btnElements = document.querySelectorAll("button[data-render]");
    const renderContent = document.querySelector(".form-content");

    btnElements.forEach((btn) => {
        btn.addEventListener("click", (e) => {
            const dataActive = e.target.dataset.render;
            const dataRender = arrRender.find(item => item.renderKey === dataActive);
            btnElements.forEach((btnChild) => {
                btnChild.classList.remove("active");
            })
            if (dataRender) {
                btn.classList.add("active");
            }
            if (dataRender && renderContent) {
                loadPartial(dataRender.elementRender, renderPartial);
                if (dataRender.urlScript) {
                    const checkExit = document.querySelector(`.${dataRender.class}`);
                    if (checkExit) return;
                    const scriptElement = document.createElement("script");
                    scriptElement.classList.add(dataRender.class);
                    scriptElement.src = dataRender.urlScript;
                    scriptElement.setAttribute("defer", "");
                    document.body.appendChild(scriptElement);
                }

            }

        })
    })
</script>
<script type="text/babel">

</script>